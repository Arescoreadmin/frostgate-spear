# Frost Gate Spear - TOPSECRET Ring Configuration
# Classification: TOP SECRET
# Version: 1.0.0

ring:
  name: TOPSECRET
  level: 3
  description: "TOP SECRET classification execution ring for highest sensitivity operations"
  color_code: "#FFA500"  # Orange

# Enclave Configuration
enclave:
  id: "enclave-ts-001"
  isolation:
    network:
      enabled: true
      vlan_id: 400
      firewall_policy: "ts-airgap-strict"
      air_gapped: true
      physical_isolation: true
      cross_domain_solution: "cds-ts-001"
      allowed_egress: []
      allowed_ingress:
        - "10.250.0.0/24"  # TS network only, minimal
      emanations_protection: true
      tempest_certified: true
    process:
      enabled: true
      namespace: "frostgate-ts"
      cgroup: "frostgate-ts"
      seccomp_profile: "ts-maximum"
      selinux_context: "frostgate_ts_t"
      capabilities_drop: "ALL"
      memory_encryption: true
      secure_enclave: true  # SGX/TDX
    storage:
      enabled: true
      encryption: "AES-256-XTS"
      key_management: "HSM-FIPS-140-3-Level-4"
      path: "/data/topsecret"
      quota_gb: 50
      fips_validated: true
      zeroize_on_delete: true
      self_encrypting_drives: true
      physical_destruction_on_decommission: true

# Allowed Operations
operations:
  reconnaissance:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
    tools:
      - internal_recon_ts
  vulnerability_scan:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
    tools:
      - acas_ts
  exploitation:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
      - GovCompliance
    tools:
      - classified_exploit_framework
  credential_access:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - AO
      - GovCompliance
  lateral_movement:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
      - GovCompliance
  persistence:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - AO
      - GovCompliance
      - Legal
  destructive:
    enabled: true
    requires_approval: true
    two_person_authorization: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
      - GovCompliance
      - Legal

# Data Handling
data:
  classification_label: "TOP SECRET"
  marking_required: true
  banner: "TOP SECRET//SCI//NOFORN"
  portion_marking: true
  codeword_support: true
  encryption_at_rest: true
  encryption_in_transit: true
  key_rotation_days: 7
  retention_days: 7300  # 20 years
  export_allowed: false
  cross_domain_transfer:
    enabled: true
    requires_cds: true
    manual_review: true
    two_person_integrity: true
    originator_approval: true
  downgrade_allowed: true
  downgrade_requires:
    - sanitization: true
    - declassification_authority: true
    - oca_approval: true
    - approval_role: "AO"
    - audit_logged: true
    - two_person_integrity: true
    - review_board: true

# Audit Configuration
audit:
  enabled: true
  log_level: "TRACE"
  worm_storage: true
  external_timestamp: true
  timestamp_authority: "ts-time.ic.gov"
  retention_days: 7300
  siem_integration: true
  log_destination: "/var/log/frostgate/topsecret"
  merkle_tree: true
  hash_algorithm: "SHA-512"
  two_person_integrity: true
  audit_of_audits: true
  continuous_monitoring: true
  anomaly_detection: true

# Resource Limits
resources:
  cpu_cores: 32
  memory_gb: 128
  storage_gb: 50
  network_bandwidth_mbps: 50
  concurrent_operations: 3

# Promotion Requirements
promotion:
  to_lab:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.98
    replay_success: 0.98
    red_team_review: true
    gov_security_review: true
    approvals_required:
      - Security
      - GovCompliance
      - AO
      - Legal
  to_canary:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.98
    replay_success: 0.98
    red_team_review: true
    gov_security_review: true
    penetration_test: true
    approvals_required:
      - Security
      - GovCompliance
      - AO
      - Legal
      - Product
  to_mission:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.99
    replay_success: 0.99
    tie_validation: true
    red_team_review: true
    gov_security_review: true
    penetration_test: true
    operational_test: true
    approvals_required:
      - Security
      - GovCompliance
      - MissionOwner
      - AO
      - Legal
      - SeniorLeadership

# Adversary Personas Allowed
personas:
  enabled: true
  signature_required: true
  attestation_required: true
  provenance_required: true
  allowed_categories:
    - "nation_state_advanced"
    - "apt_full"
    - "insider_privileged"
  persona_validation:
    hash_verification: true
    signature_verification: true
    provenance_check: true
    lineage_verification: true
  roe_override_blocked: true
  safety_override_blocked: true
  policy_override_blocked: true

# Federated Learning
fl:
  enabled: true
  ring_isolation: true
  gradient_aggregation: "secure_aggregation_mpc_threshold"
  differential_privacy:
    enabled: true
    epsilon: 0.01
    delta: 1e-10
  min_participants: 20
  cross_ring_sharing: false
  model_encryption: true
  homomorphic_encryption: true
  secure_multi_party_computation: true

# Zero Trust
zero_trust:
  enabled: true
  mtls_required: true
  per_service_identity: true
  opa_policy_check: true
  session_timeout_minutes: 5
  mfa_required: true
  hardware_token_required: true
  continuous_authentication: true
  behavioral_analysis: true
  insider_threat_detection: true

# Air Gap / Courier
air_gap:
  enabled: true
  courier_pipeline: true
  physical_media_encryption: true
  chain_of_custody: true
  two_person_integrity: true
  cleared_courier_required: true
  tamper_evident_packaging: true
  gps_tracking: false  # OPSEC

# Physical Security
physical_security:
  scif_required: true
  access_control: "biometric_plus_pin"
  visitor_escort: true
  device_restrictions: true
  rf_shielding: true
  tempest_certification: true

# Compliance
compliance:
  frameworks:
    - "NIST-800-53-High"
    - "ICD-503"
    - "CNSSI-1253"
    - "JSIG"
    - "ICD-705"
    - "DCID-6/3"
  controls_mapping: "configs/compliance/topsecret_controls.yaml"
  continuous_monitoring: true
  stig_compliance: true
  scap_scanning: true
  vulnerability_assessment_frequency_days: 7
