# Frost Gate Spear - SECRET Ring Configuration
# Classification: SECRET
# Version: 1.0.0

ring:
  name: SECRET
  level: 2
  description: "SECRET classification execution ring for classified operations"
  color_code: "#FF0000"  # Red

# Enclave Configuration
enclave:
  id: "enclave-secret-001"
  isolation:
    network:
      enabled: true
      vlan_id: 300
      firewall_policy: "secret-airgap"
      air_gapped: true
      cross_domain_solution: "cds-secret-001"
      allowed_egress: []  # No egress without CDS
      allowed_ingress:
        - "10.200.0.0/16"  # SECRET network only
    process:
      enabled: true
      namespace: "frostgate-secret"
      cgroup: "frostgate-secret"
      seccomp_profile: "secret-hardened"
      selinux_context: "frostgate_secret_t"
      capabilities_drop: "ALL"
      capabilities_add:
        - "CAP_NET_BIND_SERVICE"
    storage:
      enabled: true
      encryption: "AES-256-GCM"
      key_management: "HSM-FIPS-140-3"
      path: "/data/secret"
      quota_gb: 100
      fips_validated: true
      zeroize_on_delete: true

# Allowed Operations
operations:
  reconnaissance:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
    tools:
      - nmap
      - internal_recon
  vulnerability_scan:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
    tools:
      - nessus_classified
      - acas
  exploitation:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
    tools:
      - metasploit_classified
      - cobalt_strike_gov
  credential_access:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - AO
  lateral_movement:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
  persistence:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - AO
  destructive:
    enabled: true
    requires_approval: true
    approval_roles:
      - Security
      - MissionOwner
      - AO
      - Legal

# Data Handling
data:
  classification_label: "SECRET"
  marking_required: true
  banner: "SECRET//NOFORN"
  portion_marking: true
  encryption_at_rest: true
  encryption_in_transit: true
  key_rotation_days: 30
  retention_days: 3650  # 10 years
  export_allowed: false
  cross_domain_transfer:
    enabled: true
    requires_cds: true
    manual_review: true
  downgrade_allowed: true
  downgrade_requires:
    - sanitization: true
    - declassification_authority: true
    - approval_role: "AO"
    - audit_logged: true
    - two_person_integrity: true

# Audit Configuration
audit:
  enabled: true
  log_level: "TRACE"
  worm_storage: true
  external_timestamp: true
  timestamp_authority: "classified-time.gov"
  retention_days: 3650
  siem_integration: true
  log_destination: "/var/log/frostgate/secret"
  merkle_tree: true
  hash_algorithm: "SHA-384"
  two_person_integrity: true
  audit_of_audits: true

# Resource Limits
resources:
  cpu_cores: 64
  memory_gb: 256
  storage_gb: 100
  network_bandwidth_mbps: 100
  concurrent_operations: 5

# Promotion Requirements
promotion:
  to_lab:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.95
    replay_success: 0.95
    red_team_review: true
    approvals_required:
      - Security
      - GovCompliance
      - AO
  to_canary:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.95
    replay_success: 0.95
    red_team_review: true
    approvals_required:
      - Security
      - GovCompliance
      - AO
      - Product
  to_mission:
    sim_runs_required: 1000
    policy_violations_allowed: 0
    forensic_completeness: 0.98
    replay_success: 0.98
    tie_validation: true
    red_team_review: true
    gov_security_review: true
    approvals_required:
      - Security
      - GovCompliance
      - MissionOwner
      - AO
      - Legal

# Adversary Personas Allowed
personas:
  enabled: true
  signature_required: true
  attestation_required: true
  allowed_categories:
    - "nation_state"
    - "apt"
    - "insider"
  persona_validation:
    hash_verification: true
    signature_verification: true
    provenance_check: true
  roe_override_blocked: true
  safety_override_blocked: true

# Federated Learning
fl:
  enabled: true
  ring_isolation: true
  gradient_aggregation: "secure_aggregation_mpc"
  differential_privacy:
    enabled: true
    epsilon: 0.1
    delta: 1e-8
  min_participants: 10
  cross_ring_sharing: false
  model_encryption: true
  homomorphic_encryption: true

# Zero Trust
zero_trust:
  enabled: true
  mtls_required: true
  per_service_identity: true
  opa_policy_check: true
  session_timeout_minutes: 15
  mfa_required: true
  continuous_authentication: true
  behavioral_analysis: true

# Air Gap / Courier
air_gap:
  enabled: true
  courier_pipeline: true
  physical_media_encryption: true
  chain_of_custody: true
  two_person_integrity: true

# Compliance
compliance:
  frameworks:
    - "NIST-800-53-High"
    - "ICD-503"
    - "CNSSI-1253"
    - "JSIG"
  controls_mapping: "configs/compliance/secret_controls.yaml"
  continuous_monitoring: true
  stig_compliance: true
